<project basedir="." default="all">

    <property name="src" value="./src"></property>
    <property name="output" value="./eclipse_projects"></property>
    <property name="service.output.dir" value="${output}/service-archiver"></property>
    <property name="codegen.output.dir" value="${output}/code-gen"></property>

    <property name="source.dir.name" value="src"></property>
    <property name="lib.dir.name" value="lib"></property>
    <property name="bin.dir.name" value="bin"></property>
    <property name="help.dir.name" value="help"></property>

    <property name="codegen.resource.dir" value="./conf/codegen"></property>
    <property name="service.resource.dir" value="./conf/service"></property>

    <property name="codegen.help.resource.file" value="../../xdocs/latest/tools/eclipse/wsdl2java-plugin.html"></property>
    <property name="service.help.resource.file" value="../../xdocs/latest/tools/eclipse/servicearchiver-plugin.html"></property>
    
     <property name="codegen.help.images.dir" value="../../xdocs/latest/tools/eclipse/images"></property>
     <property name="service.help.images.dir" value="../../xdocs/latest/tools/eclipse/images"></property>

    <!-- Default target to generate all the services -->
    <target name="all">
        <antcall target="generate-service-project"/>
        <antcall target="generate-codegen-project"/>
    </target>

    <!-- init-->
    <target name="init">
        <mkdir dir="${output}"></mkdir>
        <mkdir dir="${service.output.dir}"></mkdir>
        <mkdir dir="${codegen.output.dir}"></mkdir>
    </target>
    <!-- generate the service archiver project -->
    <target name="generate-service-project" depends="init">
        <mkdir dir="${service.output.dir}/${source.dir.name}"></mkdir>
        <!-- copy the source to src -->
        <copy todir="${service.output.dir}/${source.dir.name}">
            <fileset dir="${src}" excludes="**/codegen/**/*.java"/>
        </copy>
		<!-- Copy the other stuff -->
        <copy todir="${service.output.dir}">
            <fileset dir="${service.resource.dir}"></fileset>
        </copy>
	  <!-- create bin directory -->
	  <mkdir dir="${service.output.dir}/${bin.dir.name}"></mkdir>
	  <!-- create the help directory -->
        <mkdir dir="${service.output.dir}/${help.dir.name}"></mkdir>
	  <!-- copy the help directory -->
        <copy todir="${service.output.dir}/${help.dir.name}">
            <fileset file="${service.help.resource.file}"></fileset>
        </copy>
	 <available property="images.dir" 
	                    file="${service.help.images.dir}" 
	                    type="dir" 
	                    value="${service.help.images.dir}"/>
         <copy todir="${service.output.dir}/${help.dir.name}/images">
          <fileset dir="${images.dir}"/>
         </copy> 

    </target>

    <!--generate the codegen project-->
    <target name="generate-codegen-project" depends="init">
        <mkdir dir="${codegen.output.dir}/${source.dir.name}"></mkdir>
        <!-- copy the source to src -->
        <copy todir="${codegen.output.dir}/${source.dir.name}">
            <fileset dir="${src}" excludes="**/service/**/*.java"/>
        </copy>
        <!-- Copy the other stuff -->
        <copy todir="${codegen.output.dir}">
            <fileset dir="${codegen.resource.dir}"></fileset>
        </copy>
        <!-- create bin directory -->
		<mkdir dir="${codegen.output.dir}/${bin.dir.name}"></mkdir>
        <!-- create the help directory -->
        <mkdir dir="${codegen.output.dir}/${help.dir.name}"></mkdir>
	  <!-- copy the help directory -->
        <copy todir="${codegen.output.dir}/${help.dir.name}">
            <fileset file="${codegen.help.resource.file}"></fileset>
        </copy>
          <available property="images.dir" file="${codegen.help.images.dir}" type="dir" value="${codegen.help.images.dir}"/>
          <copy todir="${codegen.output.dir}/${help.dir.name}/images">
            <fileset dir="${images.dir}"/>
         </copy>

    </target>


    <!-- Clean the directory -->
    <target name="clean">
        <delete dir="${output}"></delete>
    </target>

</project>
